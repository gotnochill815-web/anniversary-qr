<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Anniversary Player</title>

<style>
  :root{
    --pink:#ff6ea7;
    --pink2:#ff9ac5;
    --bg:#ffe6f2;
    --card:#ffffff;
    --text:#5a0030;
  }

  body{
    margin:0;
    background:var(--bg);
    color:var(--text);
    font-family: "Poppins", system-ui, sans-serif;
  }

  .wrap{
    max-width:1100px;
    margin:30px auto;
    padding:20px;
  }

  h1{
    margin:0 0 12px;
    font-size:32px;
    text-align:center;
    color:var(--text);
  }

  .card{
    background:white;
    padding:18px;
    border-radius:18px;
    box-shadow:0 6px 25px rgba(255,0,120,0.25);
    border:2px solid var(--pink2);
  }

  .player-area{
    width:100%;height:0;padding-bottom:56%;
    position:relative;border-radius:14px;
    overflow:hidden;background:#ffd3ea;
  }

  video{
    position:absolute;inset:0;
    width:100%;height:100%;
    object-fit:contain;
    transform-origin:center;
    background:black;
    border-radius:14px;
    outline:3px solid var(--pink);
  }

  .controls{
    display:flex;gap:12px;flex-wrap:wrap;
    justify-content:center;
    margin-top:15px;
  }

  button{
    background:var(--pink);
    color:white;
    border:none;
    border-radius:30px;
    padding:10px 20px;
    cursor:pointer;
    font-weight:600;
    transition:0.25s;
  }

  button:hover{
    background:var(--pink2);
    transform:translateY(-2px);
  }

  .btn-ghost{
    background:white;
    color:var(--pink);
    border:2px solid var(--pink);
  }

  .tip{
    text-align:center;
    width:100%;
    margin-top:10px;
    font-size:13px;
    color:#b8337a;
  }

  /* HEARTS CANVAS */
  #hearts{
    position:fixed;
    inset:0;
    pointer-events:none;
    z-index:5;
  }
</style>
</head>

<body>

<canvas id="hearts"></canvas>

<div class="wrap">
  <h1>üíñHappy Anniversary üíñ</h1>

  <div class="card">

    <div class="player-area">
      <video id="video" controls playsinline preload="metadata"></video>
    </div>

    <div class="controls">
      <button id="startBtn">Start (video + music)</button>
      <button id="fitBtn" class="btn-ghost">Switch: contain ‚Üí cover</button>
      <button id="rotateBtn" class="btn-ghost">Rotate 90¬∞</button>
      <button id="resetBtn" class="btn-ghost">Reset</button>
    </div>

    <div class="tip">
      Tip: If your video is vertical, use ‚Äúcontain‚Äù to show full video.
    </div>

  </div>
</div>

<audio id="bgm" src="music.mp3" preload="auto"></audio>

<script>
/* Video paths */
const VIDEO_PRIMARY = "/mnt/data/HAPPY ANNIVERSARY.mp4";
const VIDEO_FALLBACK = "video.mp4";

const video = document.getElementById("video");
const bgm   = document.getElementById("bgm");

function trySetSrc(){
  video.src = VIDEO_PRIMARY;
  fetch(VIDEO_PRIMARY,{method:"HEAD"})
  .then(r=>{ if(!r.ok) video.src = VIDEO_FALLBACK; })
  .catch(()=> video.src = VIDEO_FALLBACK);
}
trySetSrc();

document.getElementById("startBtn").onclick = async () => {
  video.currentTime = 0;
  bgm.currentTime   = 0;
  try{
    await video.play();
    await bgm.play();
    startHearts();
  }catch(e){ alert("Tap video to allow playback."); }
};

let fitContain = true;
document.getElementById("fitBtn").onclick = () => {
  fitContain = !fitContain;
  video.style.objectFit = fitContain ? "contain" : "cover";
  document.getElementById("fitBtn").textContent =
    `Switch: ${fitContain ? "contain ‚Üí cover" : "cover ‚Üí contain"}`;
};

let rotate = 0;
document.getElementById("rotateBtn").onclick = () => {
  rotate = (rotate + 90) % 360;
  video.style.transform = `rotate(${rotate}deg)`;
};

document.getElementById("resetBtn").onclick = () => {
  rotate = 0;
  fitContain = true;
  video.style.objectFit = "contain";
  video.style.transform = "";
  video.currentTime = 0;
  bgm.pause();
  bgm.currentTime = 0;
  stopHearts();
};

/* HEART ANIMATION */
const canvas = document.getElementById("hearts");
const ctx = canvas.getContext("2d");
let hearts = [];
let interval = null, frame = null;

function resize(){ canvas.width = innerWidth; canvas.height = innerHeight; }
window.onresize = resize; resize();

function spawnHeart(){
  hearts.push({
    x:Math.random()*canvas.width,
    y:canvas.height+20,
    size:20+Math.random()*30,
    alpha:1,
    vx:(Math.random()-0.5)*0.4,
    vy:- (1 + Math.random()*2),
    rot:Math.random()*1
  });
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  hearts.forEach((h,i)=>{
    h.x+=h.vx; h.y+=h.vy; h.alpha-=0.003; h.rot+=0.02;
    if(h.alpha<=0) hearts.splice(i,1);
    ctx.save();
    ctx.translate(h.x,h.y);
    ctx.rotate(h.rot);
    ctx.globalAlpha = h.alpha;
    let s=h.size;
    ctx.fillStyle="#ff6ea7";
    ctx.beginPath();
    ctx.moveTo(0,-s/3);
    ctx.bezierCurveTo(s, -s, s*1.4, s/3, 0, s);
    ctx.bezierCurveTo(-s*1.4, s/3, -s, -s, 0, -s/3);
    ctx.fill();
    ctx.restore();
  });
  frame = requestAnimationFrame(draw);
}

function startHearts(){
  interval = setInterval(spawnHeart, 200);
  draw();
}

function stopHearts(){
  clearInterval(interval);
  cancelAnimationFrame(frame);
  hearts=[];
  ctx.clearRect(0,0,canvas.width,canvas.height);
}

video.onpause = stopHearts;
video.onended = stopHearts;
</script>

</body>
</html>
